<head>

    <title>Apollo</title>
    
    <meta id="settings" content="<%=settings%>"/>
    <meta content="<%=token%>"/>

</head>
  
<link rel="stylesheet" href="/style/cyberpunk.css">  
<link rel="stylesheet" href="/style/start.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,700,1,0" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Major+Mono+Display&display=swap" rel="stylesheet">
<link rel="shrotcut icon" href="https://www.gitbook.com/cdn-cgi/image/width=40,height=40,fit=contain,dpr=1,format=auto/https%3A%2F%2F2736040151-files.gitbook.io%2F~%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FMlYPneLIcqHH1EOMSnny%252Ficon%252FR2CyiT04r15Bm7iCl3ij%252F%25D0%2591%25D0%25B5%25D0%25B7%2520%25D0%25BD%25D0%25B0%25D0%25B7%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F.jfif%3Falt%3Dmedia%26token%3Da1d0edc5-cfcc-4300-b1d6-d9712d23172d">
    
  
<section class="cyberpunk" id="main" style="height:200%">
      
    <a href="#">
        <span class="material-symbols-outlined" id="theme-id">nightlight</span>
    </a>
    
    <br/><br/>
    
    <a href="#">
        <span class="material-symbols-outlined" id="fullscreen">desktop_windows</span>
    </a>

    <br/><br/>

    <a href="/">
        <span class="material-symbols-outlined">home</span>
    </a>

    
    <div align="center">

        <h1 class="cyberpunk glitched futfont">Choose what you want to do</h1>
        <h3 class="cyberpunk futfont">You can discover all the available crypto specific features here</h3><br/><br/><br/>
   

    <label for="scope_selector" class="cyberpunk futfont" style="font-weight:bold;">
        Choose the scope
    </label><br/><br/>

    <select class="cyberpunk futfont land" id="scope_selector" style="max-width: 500px">

    <!-- SUPPORTED FORMATS WILL BE PASTED HERE  -->

    </select><br/><br/><br/><br/>

    
    <label for="operation_selector" class="cyberpunk futfont" style="font-weight:bold;">
        Choose operation
    </label><br/><br/>
    <select class="cyberpunk futfont land" id="operation_selector" style="max-width: 500px">

            <!-- SUPPORTED FORMATS WILL BE PASTED HERE  -->
    
    </select>
    
    <br/><br/><br/><br/>


    <label for="params" class="cyberpunk futfont" style="font-weight:bold;" id="params_label" hidden>
        Add parameters
    </label><br/><br/>
    <!-- <textarea class="cyberpunk" id="parameters" placeholder="paste parameters here..."></textarea>

    <br/><br/><br/> -->
    <div id="params">
    </div>

    <p class="futfont" style="font-weight:bold">Result(will be below):</p>

    <p style="font-weight:bold;font-size: larger;" id="result"></p>    <br/><br/><br/><br/>
  
    <button class="cyberpunk2077 blue-kly" onClick="letsDoIt()">Let's do it</button>

</div>
  
    <p style="bottom: 8%; left: 3%;" id="version">Apollo  v0.3.0</p>

  
  </section>
  
  <!--
  
  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
  â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
  â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•    â–ˆâ–ˆâ•‘   â•šâ•â•â•â•â–ˆâ–ˆâ•‘
  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
  â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•šâ•â•        â•šâ•â•   â•šâ•â•â•â•â•â•â•
                                                       -->
  
<script src="/scripts/upitems.js"></script>
<script src="/scripts/no_self_xss.js"></script>

<script>

    //Create values for selectors with keytypes supported by Klyntar & Apollo

    let formats=[

        'klyntar',          'algorand',
        'arweave',          'binance_chain',
        'bitcoin',          'cosmos',
        'eos',              'eth_like',
        'filecoin',         'polkadot',
        'harmony',          'helium',
        'mina',             'xrp',
        'solana',           'stellar',
        'zilliqa',          'terra',
        'dfinity',          'kusama',
        'substrate format', 'ton'
    
    ]


    let cryptoland={

        encryption:{

            encrypt:async param=>{

                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')

                    let privateKey=document.createElement('input')

                    privateKey.type="text"
                    privateKey.className="cyberpunk"
                    privateKey.placeholder="Your generated private key"
                    privateKey.id='privateKey'

                    let password=document.createElement('input')

                    password.type="text"
                    password.placeholder="Your password for AES-256"
                    password.className="cyberpunk"
                    password.id='password'

                    params.appendChild(privateKey)
                    params.appendChild(password)


                }else{
                          
                    //Logic after button clicked

                    let cipherTextPrivateKey=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'crypt',
                                operation:'encrypt',
                                params:`${document.getElementById('password').value}:${document.getElementById('privateKey').value}`
                            }
                        )

                    }).then(r=>r.text())
                                        
                    document.getElementById('result').innerHTML=cipherTextPrivateKey
                
                }
                 
            },
            decrypt:async param=>{


                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')

                    let cipherTextOfPrivate=document.createElement('input')

                    cipherTextOfPrivate.type="text"
                    cipherTextOfPrivate.className="cyberpunk"
                    cipherTextOfPrivate.placeholder="Ciphertext of your private key"
                    cipherTextOfPrivate.id='cipherText'

                    let password=document.createElement('input')

                    password.type="text"
                    password.placeholder="Your password for AES-256"
                    password.className="cyberpunk"
                    password.id='password'

                    params.appendChild(cipherTextOfPrivate)
                    params.appendChild(password)


                }else{

                    //Logic after button clicked
                    let plainTextPrivateKey=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'crypt',
                                operation:'decrypt',
                                params:`${document.getElementById('password').value}:${document.getElementById('cipherText').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=plainTextPrivateKey
                
                }
                

            }
        
        },

        default_signatures:{
            
            sign:async param=>{

                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    //Create field text to sign
                    let textToSign=document.createElement('input')

                    textToSign.type="text"
                    textToSign.className="cyberpunk"
                    textToSign.placeholder="Enter anything you want to sign"
                    textToSign.id='toSign'


                    //Create field for private key
                    let privateKey=document.createElement('input')

                    privateKey.type="text"
                    privateKey.placeholder="Your private key"
                    privateKey.className="cyberpunk"
                    privateKey.id='privateKey'


                    //To choose keytype for ValarDohaeris 
                    let availableKeys=document.createElement('select')
                    availableKeys.className="cyberpunk futfont"
                    availableKeys.id="key_selector"
                    availableKeys.style="max-width: 500px"
    
    
                    formats.forEach(format=>{

                        let newbiew=document.createElement('option')

                        newbiew.innerHTML=format

                        availableKeys.appendChild(newbiew)

                    })


                    //Finally add them to DOM
                    params.appendChild(textToSign)
                    params.appendChild(privateKey)
                    params.appendChild(availableKeys)

                }else{

                    //Logic after button clicked

                    let signa=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'default_signatures',
                                operation:'sign',
                                params:`${document.getElementById('toSign').value}@${ document.getElementById('privateKey').value}@${document.getElementById('key_selector').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=signa
                
                }

            },
            verify:async param => {


                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    //Create field for signature to verify it
                    let signature=document.createElement('input')

                    signature.type="text"
                    signature.className="cyberpunk"
                    signature.placeholder="Enter signature you want to verify"
                    signature.id='signa'


                    //Create field for private key
                    let publicKey=document.createElement('input')

                    publicKey.type="text"
                    publicKey.placeholder="Public key / Address of signer"
                    publicKey.className="cyberpunk"
                    publicKey.id='publicKey'

                                        //Create field for private key
                    let plainText=document.createElement('input')

                    plainText.type="text"
                    plainText.placeholder="Text you want to verify"
                    plainText.className="cyberpunk"
                    plainText.id='plainText'

                    //To choose keytype for ValarDohaeris 
                    let availableKeys=document.createElement('select')
                    availableKeys.className="cyberpunk futfont"
                    availableKeys.id="key_selector"
                    availableKeys.style="max-width: 500px"
    
    
                    formats.forEach(format=>{

                        let newbiew=document.createElement('option')

                        newbiew.innerHTML=format

                        availableKeys.appendChild(newbiew)

                    })


                    //Finally add them to DOM
                    params.appendChild(signature)
                    params.appendChild(publicKey)
                    params.appendChild(plainText)
                    params.appendChild(availableKeys)

                }else{

                    //Logic after button clicked

                    let signa=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'default_signatures',
                                operation:'verify',
                                params:`${document.getElementById('plainText').value}@${ document.getElementById('publicKey').value}@${document.getElementById('key_selector').value}@${document.getElementById('signa').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=signa
                
                }


            }
        
        },
        
        multisig:{
            
            generate:async param=>{

                if(param==='prompt') document.getElementById('params_label').innerHTML='no params needed,just press the button ðŸš€'

                else{

                    let pair=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify({

                            scope:'multisig',
                            operation:'generate'

                        })

                    }).then(r=>r.json())

                    document.getElementById('result').innerHTML=JSON.stringify(pair)

                }

            },
            sign:async param=>{

                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    //Create field msg to sign
                    let textToSign=document.createElement('input')

                    textToSign.type="text"
                    textToSign.className="cyberpunk"
                    textToSign.placeholder="Enter anything you want to sign"
                    textToSign.id='toSign'


                    //Create field for private key
                    let privateKey=document.createElement('input')

                    privateKey.type="text"
                    privateKey.placeholder="Your BLS multisig private key"
                    privateKey.className="cyberpunk"
                    privateKey.id='privateKey'
 
                    
                    //Finally add them to DOM
                    params.appendChild(textToSign)
                    params.appendChild(privateKey)

                }else{

                    let signature=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'multisig',
                                operation:'sign',
                                params:`${document.getElementById('toSign').value}:${document.getElementById('privateKey').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=signature
                    

                }

            },
            verify:async param=>{

                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    //Create field for signature to verify it
                    let signature=document.createElement('input')

                    signature.type="text"
                    signature.className="cyberpunk"
                    signature.placeholder="Enter signature you want to verify / Master signature(aggregated)"
                    signature.id='signa'


                    //Create field for private key
                    let publicKey=document.createElement('input')

                    publicKey.type="text"
                    publicKey.placeholder="Public key of signer / Master pubkey(aggregated)"
                    publicKey.className="cyberpunk"
                    publicKey.id='publicKey'

                                        //Create field for private key
                    let plainText=document.createElement('input')

                    plainText.type="text"
                    plainText.placeholder="Message you want to verify"
                    plainText.className="cyberpunk"
                    plainText.id='plainText'


                    //Finally add them to DOM
                    params.appendChild(signature)
                    params.appendChild(publicKey)
                    params.appendChild(plainText)

                }else{

                    let isVerified=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'multisig',
                                operation:'verify',
                                params:`${document.getElementById('plainText').value}:${document.getElementById('publicKey').value}:${document.getElementById('signa').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=isVerified
                    
                }

            },
            aggregateSignatures:async param=>{

                   if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    //Create field to enumerate signatures to get master signature
                    let signatures=document.createElement('textArea')

                    signatures.type="text"
                    signatures.className="cyberpunk"
                    signatures.placeholder="Signa1:Signa2:...:SignaN"
                    signatures.id='signatures'

                    //Finally add them to DOM
                    params.appendChild(signatures)

                }else{

                    let masterSignature=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'multisig',
                                operation:'aggregateSignatures',
                                params:`${document.getElementById('signatures').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=masterSignature
                    
                }

            },
            aggregatePubKeys:async param=>{

                   if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    //Create field to enumerate signatures to get master signature
                    let pubKeysToAggregate=document.createElement('textArea')

                    pubKeysToAggregate.type="text"
                    pubKeysToAggregate.className="cyberpunk"
                    pubKeysToAggregate.placeholder="PubKey1:PubKey2:...:PubKeyN"
                    pubKeysToAggregate.id='pubkeys'

                    //Finally add them to DOM
                    params.appendChild(pubKeysToAggregate)

                }else{
                    
                    let masterPubKey=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'multisig',
                                operation:'aggregatePubKeys',
                                params:`${document.getElementById('pubkeys').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=masterPubKey

                }

            },
        },
        
        ringsig:{
            
            generate:async param=>{

                if(param==='prompt') document.getElementById('params_label').innerHTML='no params needed,just press the button ðŸš€'
                else{

                    let pair=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify({

                            scope:'ringsig',
                            operation:'generate'

                        })

                    }).then(r=>r.json())

                    document.getElementById('result').innerHTML=JSON.stringify(pair,null,32)

                }

            },
            ringSign:async param=>{

                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    //Create field msg to sign
                    let textToSign=document.createElement('input')

                    textToSign.type="text"
                    textToSign.className="cyberpunk"
                    textToSign.placeholder="Enter anything you want to sign"
                    textToSign.id='toSign'


                    //Create field for private key
                    let privateKey=document.createElement('input')

                    privateKey.type="text"
                    privateKey.placeholder="Your ringsig private key"
                    privateKey.className="cyberpunk"
                    privateKey.id='privateKey'
 
                    //Area to enumerate pukeys for ring
                    let ring=document.createElement('textArea')

                    ring.type="text"
                    ring.className="cyberpunk"
                    ring.placeholder="Ring of pubkeys (Pub1:Pub2:...:PubN)"
                    ring.id='ring'
                    
                    //Finally add them to DOM
                    params.appendChild(textToSign)
                    params.appendChild(privateKey)
                    params.appendChild(ring)


                }else{

                    let signature=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'ringsig',
                                operation:'sign',
                                params:`${document.getElementById('toSign').value},${document.getElementById('privateKey').value},${document.getElementById('ring').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=signature
                    

                }

            },
            ringVerify:async param=>{

                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    //Create field for signature to verify it
                    let signature=document.createElement('input')

                    signature.type="text"
                    signature.className="cyberpunk"
                    signature.placeholder="Enter signature you want to verify"
                    signature.id='signa'


                    let ring=document.createElement('textarea')

                    ring.type="text"
                    ring.placeholder="Ring of pubkeys (Pub1:Pub2:...:PubN)"
                    ring.className="cyberpunk"
                    ring.id='ring'


                    //Finally add them to DOM
                    params.appendChild(signature)
                    params.appendChild(ring)

                }else{

                    let isVerified=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'ringsig',
                                operation:'verify',
                                params:`${document.getElementById('signa').value},${document.getElementById('ring').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=isVerified
                    
                }


            },
            link:async param=>{


                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')

                    let fields=['1','2']

                    fields.forEach(field=>{

                        //Create field for signature1
                        let signature=document.createElement('input')
                    
                        signature.type="text"
                        signature.className="cyberpunk"
                        signature.placeholder=`Enter signature${field} to link`
                        signature.id='signa'+field

                        //Finally add them to DOM
                        params.appendChild(signature)

                    })
 
                }else{

                    let isLinked=await fetch('/cryptoland',{
                        method:'POST',
                        body:JSON.stringify(
                            {
                                scope:'ringsig',
                                operation:'link',
                                params:`${document.getElementById('signa1').value}:${document.getElementById('signa2').value}`
                            }
                        )

                    }).then(r=>r.text())

                    document.getElementById('result').innerHTML=isLinked
                    
                }

            }

        },
        
        thresholdsig:{
            
            generate:async param=>{
                
                if(param==='prompt'){

                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')

                    let threshold=document.createElement('input')

                    threshold.type="number"
                    threshold.className="cyberpunk"
                    threshold.placeholder="Threshold for t/n"
                    threshold.id="threshold"
                    threshold.min=1

                    let myId=document.createElement('input')

                    myId.type="text"
                    myId.placeholder="Your ID"
                    myId.className="cyberpunk"
                    myId.id="myId"


                    let idsArray=document.createElement('input')

                    idsArray.type="text"
                    idsArray.placeholder="IDs of other members. Example 1,2,3 or David,Nancy,Alex. Your ID also must be here"
                    idsArray.className="cyberpunk"
                    idsArray.id="idsArray"

                    let explainTip=document.createElement('label')
                    explainTip.className="cyberpunk futfont"
                    explainTip.for="idsArray"
                    explainTip.style="font-weight:bold;"

                    params.appendChild(threshold)
                    params.appendChild(myId)
                    params.appendChild(idsArray)
                    params.appendChild(explainTip)

                }
                else{

                    
                    let tblsCreds=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'tsig',
                            operation:'generate',
                            params:`${document.getElementById('threshold').value}:${document.getElementById('myId').value}:${document.getElementById('idsArray').value}`

                        })

                    }).then(r=>r.json())

                    let result=document.getElementById('result')

                    result.innerHTML='<br/><br/><br/><br/>'+'<span align="center" class="futfont">send this verification vector to all other members:</span>'+'<br/><br/>'+`${JSON.stringify(tblsCreds.verificationVector)}`+'<br/><br/><br/>'


                    //Log shares to share among other sides
                    result.innerHTML+=`<br/><br/><span class="futfont">Shares:</span><br/><br/>  <ul>`


                    let ids=document.getElementById('idsArray').value.split(',')

                    console.log(tblsCreds)

                    tblsCreds.secretShares.forEach((share,index)=>{

                        result.innerHTML+=`<li>For user with id ${ids[index]} => ${share}`+'</li>'
                        
                    })

                    result.innerHTML+=`</ul><br/><span class="futfont">Your new id: </span>${tblsCreds.id}<br/><br/>`

                }

            },
            verifyShare:async param=>{

                if(param==='prompt'){
                    
                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')

                    let hexMyId=document.createElement('input')

                    hexMyId.type="text"
                    hexMyId.className="cyberpunk"
                    hexMyId.placeholder="Your ID in hex format"
                    hexMyId.id="hexMyId"

                    let hexSomeSignerSecretKeyContribution=document.createElement('input')

                    hexSomeSignerSecretKeyContribution.type="text"
                    hexSomeSignerSecretKeyContribution.placeholder="Share received from someone X"
                    hexSomeSignerSecretKeyContribution.className="cyberpunk"
                    hexSomeSignerSecretKeyContribution.id="hexSomeSignerSecretKeyContribution"


                    let verificationVector=document.createElement('input')

                    verificationVector.type="text"
                    verificationVector.placeholder="Verification vector of someone who want to prove validity of share"
                    verificationVector.className="cyberpunk"
                    verificationVector.id="vv"

                    params.appendChild(hexMyId)
                    params.appendChild(hexSomeSignerSecretKeyContribution)
                    params.appendChild(verificationVector)
                    
                }
                else{

                    
                    let isValidShare=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'tsig',
                            operation:'verifyShare',
                            params:`${document.getElementById('hexMyId').value}:${document.getElementById('hexSomeSignerSecretKeyContribution').value}`,
                            vv:JSON.parse(document.getElementById('vv').value)

                        })

                    }).then(r=>r.json())

                    let result=document.getElementById('result')

                    result.innerHTML=isValidShare

                }

            },
            deriveGroupPub:async param=>{

                
                if(param==='prompt'){
                    
                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')

                    let vvsList=document.createElement('textarea')

                    vvsList.className="cyberpunk"
                    vvsList.placeholder="Enter verification vectors of all members in form of VV1 / VV2 ... /VVn"
                    vvsList.id="vvs_list"

                    params.appendChild(vvsList)
                    
                }
                else{

                    
                    let derivedMasterKey=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'tsig',
                            operation:'deriveGroupPub',
                            params:document.getElementById('vvs_list').value.split('/').map(JSON.parse)
                            
                        })

                    }).then(r=>r.text())

                    let result=document.getElementById('result')

                    result.innerHTML=derivedMasterKey

                }

            },
            signaShare:async param=>{
                        
                if(param==='prompt'){
                    
                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')

                    let vvsList=document.createElement('textarea')

                    vvsList.className="cyberpunk"
                    vvsList.placeholder="Enter verification vectors of all members in form of VV1/VV2 ... /VVn"
                    vvsList.id="vvs_list"
                    
                    let sigSharesList=document.createElement('textarea')

                    sigSharesList.className="cyberpunk"
                    sigSharesList.placeholder="Enter shares received from another members in form of SHARE1/SHARE2 ... /SHAREn"
                    sigSharesList.id="shares_list"

                    
                    let hexMyId=document.createElement('input')

                    hexMyId.type="text"
                    hexMyId.className="cyberpunk"
                    hexMyId.placeholder="Your ID in hex format"
                    hexMyId.id="hexMyId"


                    let message=document.createElement('input')

                    message.type="text"
                    message.className="cyberpunk"
                    message.placeholder="Message to sign"
                    message.id="msg"


                    params.appendChild(vvsList)
                    params.appendChild(sigSharesList)
                    params.appendChild(hexMyId)
                    params.appendChild(message)

                }
                else{

                    
                    let sigShare=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'tsig',
                            operation:'signaShare',
                            params:`${document.getElementById('hexMyId').value}:${document.getElementById('msg').value}`,
                            vv:document.getElementById('vvs_list').value.split('/').map(JSON.parse),
                            sharesArray:document.getElementById('shares_list').value.split('/')
                            
                        })

                    }).then(r=>r.text())

                    let result=document.getElementById('result')

                    result.innerHTML=sigShare

                }

            },
            buildFullSignature:async param=>{

                if(param==='prompt'){
                    
                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')

                    let sigShares=document.createElement('textarea')

                    sigShares.className="cyberpunk"
                    sigShares.placeholder="Enter signature shares of all members in form of Ssa/Ssb ... /Ssx"
                    sigShares.id="sigShares"
                    
                    let hexIdsList=document.createElement('textarea')

                    hexIdsList.className="cyberpunk"
                    hexIdsList.placeholder="Enter appropriate your hex IDs IDa/IDb ... /IDx"
                    hexIdsList.id="hexIdsList"

                
                    params.appendChild(sigShares)
                    params.appendChild(hexIdsList)
                   
                }
                else{
                    
                    /*

                        signaturesArray - [ {sigShare:signedShareA,id:hexIdA}, {sigShare:signedShareB,id:hexIdB},... {sigShare:signedShareX,id:hexIdX} ]

                    */

                    let partialSignatures=document.getElementById('sigShares').value.split('/'),

                        hexIdsArray=document.getElementById('hexIdsList').value.split('/')

                    let payloadToSend=partialSignatures.map(
                        
                        (value,index) => ({sigShare:value,id:hexIdsArray[index]})
                        
                    )
                    
                    let fullSignature=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'tsig',
                            operation:'buildFullSignature',
                            params:payloadToSend
                            
                        })

                    }).then(r=>r.text())

                    let result=document.getElementById('result')

                    result.innerHTML=fullSignature

                }

            },
            verify:async param=>{

                if(param==='prompt'){
                    
                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')

                    let masterPubKey=document.createElement('input')

                    masterPubKey.type="text"
                    masterPubKey.className="cyberpunk"
                    masterPubKey.placeholder="Enter master pubkey"
                    masterPubKey.id="masterPubKey"
                    
                    let masterSignature=document.createElement('input')

                    masterSignature.type="text"
                    masterSignature.className="cyberpunk"
                    masterSignature.placeholder="Enter master signature"
                    masterSignature.id="masterSig"

                    let message=document.createElement('input')

                    message.type="text"
                    message.className="cyberpunk"
                    message.placeholder="Enter message to sign"
                    message.id="message"

                
                    params.appendChild(masterPubKey)
                    params.appendChild(masterSignature)
                    params.appendChild(message)
                   
                }
                else{
                    
                    let isVerifiedMasterSig=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'tsig',
                            operation:'verify',
                            params:`${document.getElementById('masterPubKey').value}:${document.getElementById('masterSig').value}:${document.getElementById('message').value}`
                            
                        })

                    }).then(r=>r.text())

                    let result=document.getElementById('result')

                    result.innerHTML=isVerifiedMasterSig

                }

            }
        },
        



        post_quantum:{

            gen_DIL:async param=>{

                if(param==='prompt') document.getElementById('params_label').innerHTML='no params needed,just press the button ðŸš€'
                else{

                    let isVerifiedMasterSig=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'pqc',
                            operation:'gen_DIL'
                            
                        })

                    }).then(r=>r.text())

                    let result=document.getElementById('result')

                    result.innerHTML=isVerifiedMasterSig

                }

            },

            gen_BLISS:async param=>{

                if(param==='prompt') document.getElementById('params_label').innerHTML='no params needed,just press the button ðŸš€'
                else{

                    let isVerifiedMasterSig=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'pqc',
                            operation:'gen_BLISS'
                            
                        })

                    }).then(r=>r.text())

                    let result=document.getElementById('result')

                    result.innerHTML=isVerifiedMasterSig

                }

            },
            
            sign:async param=>{

                if(param==='prompt'){
                    
                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    let privateKey=document.createElement('input')

                    privateKey.type="text"
                    privateKey.className="cyberpunk"
                    privateKey.placeholder="Enter PQC private key"
                    privateKey.id="privateKey"
                    
                    let message=document.createElement('input')

                    message.type="text"
                    message.className="cyberpunk"
                    message.placeholder="Enter message to sign"
                    message.id="message"


                    // BLISS or DILITHIUM
                    let availableAlgs=document.createElement('select')
                    availableAlgs.className="cyberpunk futfont"
                    availableAlgs.id="alg_selector"
                    availableAlgs.style="max-width: 500px"
    
                    let algs=['sign_DIL','sign_BLISS']
    
                    algs.forEach(format=>{

                        let newbiew=document.createElement('option')

                        newbiew.innerHTML=format

                        availableAlgs.appendChild(newbiew)

                    })

                    params.appendChild(privateKey)
                    params.appendChild(message)
                    params.appendChild(availableAlgs)
                   
                }
                else{
                    
                    let signature=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'pqc',
                            operation:document.getElementById('alg_selector').value,
                            params:`${document.getElementById('privateKey').value},${document.getElementById('message').value}`
                            
                        })

                    }).then(r=>r.text())

                    let result=document.getElementById('result')

                    result.innerHTML=signature

                }


            },
            
            verify:async param=>{

                if(param==='prompt'){
                    
                    document.getElementById('params_label').innerHTML='Add parameters'

                    let params=document.getElementById('params')


                    let publicKey=document.createElement('input')

                    publicKey.type="text"
                    publicKey.className="cyberpunk"
                    publicKey.placeholder="Enter PQC pubkey"
                    publicKey.id="publicKey"
                    
                    let message=document.createElement('input')

                    message.type="text"
                    message.className="cyberpunk"
                    message.placeholder="Enter message to verify"
                    message.id="message"

                    let signa=document.createElement('input')

                    signa.type="text"
                    signa.className="cyberpunk"
                    signa.placeholder="Enter signature to verify"
                    signa.id="signa"

                    // BLISS or DILITHIUM
                    let availableAlgs=document.createElement('select')
                    availableAlgs.className="cyberpunk futfont"
                    availableAlgs.id="alg_selector"
                    availableAlgs.style="max-width: 500px"
    
                    let algs=['verify_DIL','verify_BLISS']
    
                    algs.forEach(format=>{

                        let newbiew=document.createElement('option')

                        newbiew.innerHTML=format

                        availableAlgs.appendChild(newbiew)

                    })

                    params.appendChild(publicKey)
                    params.appendChild(message)
                    params.appendChild(signa)
                    params.appendChild(availableAlgs)
                   
                }
                else{
                    
                    let isVerified=await fetch('/cryptoland',{
                        
                        method:'POST',
                        body:JSON.stringify({

                            scope:'pqc',
                            operation:document.getElementById('alg_selector').value,
                            params:`${document.getElementById('message').value},${document.getElementById('publicKey').value},${document.getElementById('signa').value}`
                            
                        })

                    }).then(r=>r.text())

                    let result=document.getElementById('result')

                    result.innerHTML=isVerified

                }

            },
        
        }
    
    }


    //Fill the selectors
    let scopeSelector=document.getElementById('scope_selector')

    let operationSelector=document.getElementById('operation_selector')


    // SET PROMPT
    let newbiew=document.createElement('option')

    newbiew.value=""
    newbiew.disabled=true
    newbiew.selected=true
    newbiew.hidden=true
    newbiew.innerHTML='Press here'

    scopeSelector.appendChild(newbiew)
//___________________________________________


    //FIll the selector to allow you to choose everything you need
    Object.keys(cryptoland).forEach(scope=>{

        let newbiew=document.createElement('option')

        newbiew.innerHTML=scope

        scopeSelector.appendChild(newbiew)


    })


    //Set handler for change events of scope
    document.getElementById('scope_selector').addEventListener('change',()=>{

        document.getElementById('params_label').hidden=true

        //Get the value of scope
        let scopeSelectorValue=document.getElementById('scope_selector').value

        //Get node to fill it
        let operationSelector=document.getElementById('operation_selector')

        
        operationSelector.replaceChildren()

        // SET PROMPT
        let newbiew=document.createElement('option')

        newbiew.value=""
        newbiew.disabled=true
        newbiew.selected=true
        newbiew.hidden=true
        newbiew.innerHTML='now choose operation'

        operationSelector.appendChild(newbiew)
        //___________________________________________

        //FIll the selector to allow you to choose everything you need
        Object.keys(cryptoland[scopeSelectorValue]).forEach(func=>{

            let newbiew=document.createElement('option')

            newbiew.innerHTML=func

            operationSelector.appendChild(newbiew)

        })


    })


    //Set handler to change events of scope
    document.getElementById('operation_selector').addEventListener('change',()=>{

        document.getElementById('params_label').hidden=true

        document.getElementById('params').replaceChildren()

        //Get the value of scope
        let scopeSelectorValue=document.getElementById('scope_selector').value

        //Get the operation
        let operationSelector=document.getElementById('operation_selector').value

        cryptoland[scopeSelectorValue][operationSelector]('prompt')

        document.getElementById('params_label').hidden = false

    })


    let letsDoIt=()=>{
      
        //Get the value of scope
        let scopeSelectorValue=document.getElementById('scope_selector').value

        //Get the operation
        let operationSelector=document.getElementById('operation_selector').value

        cryptoland[scopeSelectorValue][operationSelector]()
        
    }
    


</script>